<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapLibre GL JS Map with GeoJSON</title>
    <script src="https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.css" rel="stylesheet" />
    <style>
        body { margin: 0; padding: 0; }
        #map { width: 100%; height: 100vh; }
    </style>
</head>
<body>
    <div id="map"></div>
    <script>
        // Map style for Thunderforest Landscape
        const style = {
            "version": 8,
            "name": "Thunderforest Landscape",
            "glyphs": "https://demotiles.maplibre.org/font/{fontstack}/{range}.pbf", // Added this line
            "sources": {
                "raster-tiles": {
                    "type": "raster",
                    "tiles": [
                        "https://tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey=7c352c8ff1244dd8b732e349e0b0fe8d"
                    ],
                    "tileSize": 256,
                    "attribution": "© <a href='http://www.thunderforest.com/'>Thunderforest</a>, © <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors"
                }
            },
            "layers": [
                {
                    "id": "simple-tiles",
                    "type": "raster",
                    "source": "raster-tiles",
                    "minzoom": 0,
                    "maxzoom": 22
                }
            ]
        };

        // Initialize the map
        const map = new maplibregl.Map({
            container: 'map',
            style: style,
            bounds: [[minx, miny], [maxx, maxy]],  // replaced by python
            fitBoundsOptions: {
                padding: 50,  // Add padding around the bounds
                maxZoom: 14,  // Limit maximum zoom level
                duration: 1000  // Smooth animation (1 second)
            } // Initial zoom level (adjust as needed)
        });

        // Load the GeoJSON and add layers
        map.on('load', () => {
            // Add GeoJSON source
            map.addSource('geojson-data', {
                type: 'geojson',
                data: 'nameToReplace'  // Replace with actual GeoJSON file address later
            });

            // Add linestrings layer (for LineString geometries)
            map.addLayer({
                id: 'linestrings-layer',
                type: 'line',
                source: 'geojson-data',
                filter: ['==', '$type', 'LineString'],  // Filter for linestrings
                paint: {
                    'line-color': '#000',
                    'line-width': ['step', ['zoom'], 1, 8, 2]
                }
            });

            // Add labels for linestrings (automatic positioning and orientation)
            map.addLayer({
                id: 'linestrings-labels',
                type: 'symbol',
                source: 'geojson-data',
                minzoom: 8,  // Only show line labels when zoom is 8 or above
                filter: ['==', '$type', 'LineString'],
                layout: {
                    'text-field': '{ELEV}',  // Replace with your property containing label text
                    'symbol-placement': 'line',
                    'text-rotation-alignment': 'auto',
                    'text-keep-upright': true,
                    'text-size': 14,
                    'text-allow-overlap': false,
                    'text-ignore-placement': false,
                    'text-offset': [0, 0],
                    'symbol-spacing': 250
                },
                paint: {
                    'text-color': '#000',
                    'text-halo-color': '#fff',
                    'text-halo-width': 2
                }
            });

            // Add points layer (for Point geometries)
            map.addLayer({
                id: 'points-layer',
                type: 'circle',
                source: 'geojson-data',
                filter: ['==', '$type', 'Point'],  // Filter for points
                paint: {
                    'circle-radius': 5,
                    'circle-color': '#ff0000',  // red
                    'circle-stroke-width': 2,
                    'circle-stroke-color': '#fff'
                }
            });

            // Add labels for points
            map.addLayer({
                id: 'points-labels',
                type: 'symbol',
                source: 'geojson-data',
                minzoom: 8,  // Only show point labels when zoom is 8 or above
                filter: ['==', '$type', 'Point'],  // Filter for points
                layout: {
                    'text-field': '{name}',  // Replace 'name' with the property containing label text
                    'text-size': 15,
                    'text-allow-overlap': false,
                    'text-ignore-placement': false,
                    'text-offset': [0.8, 0.8]  // Offset labels above the point
                },
                paint: {
                    'text-color': '#000',
                    'text-halo-color': '#fff',  // White halo for readability
                    'text-halo-width': 2
                }
            });
        });

        // Error handling
        map.on('error', (e) => {
            console.error('Map error:', e);
        });
    </script>
</body>
</html>